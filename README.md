# gulp-2022
Руководство Gulp 2022

- Использование ES6 модулей
- Автоматическая конвертация шрифтов
- Подключение шрифтов в CSS-файл
- Создание ZIP-архива с результатом
- Выкладывание ZIP-архива на FTP
- Оптимизация изображений
- и мн. др.

Также настроим gulp на работу в двух режимах, в режиме разработчика и в режиме продакшена.

## Установки
- `node.js`: https://nodejs.org/ru/ (далее, далее, далее)
- `git`: https://git-scm.com/ (можно не устанавливать, встроенный терминал винды powershell тоже щ стал хорош)
- создаём папку в корне диска, в пути не должно быть кириллицы, пробелов и других символов не являющихся буквенно-числовыми: `gulp2022`
- писать будем в редакторе VSC (обычно открывают с правми админа, правая кнопка по ярлыку), можно настроить чтобы всегда открывался от имени админа:
    - правая кнопка
    - свойства
    - дополнительно
    - галочка
- работаем в терминале в папке `gulp2022`
    - проверяем версию ноды: `node --version`
    - проверяем версию npm: `npm --version`

## Создание сборки
- устанавливаем `gulp-cli` глобально `npm install --global gulp-cli`
    - проверяем установлен ли: 
- создаём `package.json` (npm init)
- устанавливаем `gulp` локально `npm install --save-dev gulp`
    - `--save-dev` - пакет нужен при разработке проекта
- создаём файловую структуру проекта `file strukture`
- создаём задачу **copy** копирования файлов для тестирования проекта
- создаём **watch** который будет наблюдать за тестовыми файлами
- создаём задачу **reset** для удаления папки `dist`, перед запуском `gulp`, это необходимо чтобы все файлы удалённые в папке `src` были также удалены и в `dist`
- Задачи по обработке HTML-файлов:
    - создаём задачу **html**
    - устанавливаем пакет для сборки html файлов `gulp-file-include`
        - решаем проблему с изображениями при подключении html файлов подробнее на `package/gulp-file-include.md`
    - установка пкета `gulp-replace`
- Подключаем формат изображений `webp`
    - устанавливаем пакет `gulp-webp-html-nosvg`

## Копируем файлы из `src` в `dist`

`/gulp/config/path.js`:

    build: {
        files: `${buildFolder}/files/`, // куда копируем файлы и папки
    }, // объект путей к папке с результатом
    src: {
        files: `${srcFolder}/files/**/*.*`, // копируем все файлы и папки внутри папки files
    }, // объект путей к исходным файлам

`gulpfile.js`:

    // Импортируем gulp из пакета gulp
    import gulp from "gulp"
    // Импортируем объект с путями из файла
    import { path } from "./gulp/config/path.js"

    // Передаём значения в глобальную переменную
    global.app = {
        gulp: gulp,
        path: path,
    }

`/gulp/task/copy.js`:

    // Тестова функция, копирующая файлы из src в dist
    export const copy = () => {
        // Обращаемся к глобальной переменной app
        return app.gulp.src(app.path.src.files) // получаем доступ к файлам
        .pipe(app.gulp.dest(app.path.build.files)) // копируем файлы
    }

`gulpfile.js`:

    // Импортируем задачу копирования
    import { copy } from "./gulp/tasks/copy.js"

    // Заносим задачу копирования в "по-умлочанию"
    gulp.task("default", copy)

Создаём файл `/src/html/index.html`

В консоли вводим:

    gulp

Выполнится дефолтная задача, в нашем случае `copy`.
